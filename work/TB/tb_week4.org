
* MA (移动平均线)

  1. 说明
     
     将某一段的收盘价之和除以该周期，譬如，日线 MA5 指的是 5 日内的收盘价除以 5.
     
  2. e.g. 画出 5 日/10 日均线，颜色分别为黄色和蓝色

     - 新建计算均值的用户函数 =CalMA= ，返回值为 'Numeric' 类型

       #+BEGIN_EXAMPLE
         Params
           NumericSeries Price(0); // 接受收盘价
           Numeric Length(0); // 周期

         Vars
           Numeric Sum(0);
           Numeric i(0);
  
         Begin
           For i = 0 To Length - 1
           {
             Sum = Sum + Price[i];
           }

           Return Sum/Length;
         End
       #+END_EXAMPLE

     - 新建用户公式

       #+BEGIN_EXAMPLE
         Param
           Numeric Length1(5);
           Numeric Length2(10);

         Begin
           PlotNumeric("短周期均线", CalMA(Close, Length1), 0, Yellow);
           PlotNumeric("短周期均线", CalMA(Close, Length2), 0, Blue);
         End
       #+END_EXAMPLE

* EMA (指数移动平均线)
  
  1. 说明
     
     EMA (Exponential Moving Average), 指数平均数指标，也叫 EXPMA 指标，它也是一种
     趋向性指标，指标平均数指标是以指数式递减加权的移动平均。

  2. 公式

     #+BEGIN_SRC latex
       \begin{equation}
         EMA_{today} = \alpha \times Price_{today} + (1-\alpha)\times EMA_{yesterday}
       \end{equation}
     #+END_SRC

     其中， $\alpha$ 为平滑指数， 一般取做 $2/(N+1)$.

  3. 解读
     EMA 指标中，每天价格的权重系数以指数等比形式缩小，时间越靠近当今时刻，其权重越大，说明 EMA
     函数对近期价格加强了权重比，更能及时反映近期价格波动情况。所以 EMA 比 MA 更具有参考价值，
     而 EMA 也不容易出现死叉和金叉，所以一旦出现需要立即做出反映。对周线处理，EMA 就更加稳定了。

  4. 源码

     #+BEGIN_EXAMPLE
       Params
         Numeric Length(10);

       Vars
         NumericSeries Ema(0);
         Numeric Alpha(0);

       Begin

         If(CurrentBar == 0) Ema = Close;
         Else{
           Alpha = 2/(Length+1);
           Ema = Alpha*Close + (1-Alpha)*Ema[1];
         }
       End
     #+END_EXAMPLE

* DEMA (双重指数移动平均线)

  1. 说明

     双重指数移动平均线是为了减少普通移动平均线中出现滞后时间而开发的更快速更平滑的移动平均线。

  2. 公式

     #+BEGIN_SRC latex
       \begin{equation}
         (N 日的 EMA 的 DEMA) = 2 \times N 日的 EMA - N 日的 EMA 的 EMA
       \end{equation}
     #+END_SRC

     变形有
     
     #+BEGIN_SRC latex
       \begin{equation}
         ((N 日的 EMA 的 DEMA) + N 日的 EMA 的 EMA)/2 = N 日的 EMA 
       \end{equation}
     #+END_SRC

  3. 解读

     DEMA 不是简单对 EMA 再进行指数平均，也不是移动平均线的移动平均线，是单一 EMA 和 双重 EMA 的结合，
     比两种都更少滞后。

  4. 源码

     #+BEGIN_EXAMPLE
       Params
         Numeric Length(10);

       Vars
         NumericSeries Ema(0);
         NumericSeries Eema(0);
         NumericSeries my_Dema(0);
         Numeric Alpha(0);

       Begin
         If(CurrentBar == 0)
         {
           Ema = Close;
           Eema = Close;
         }Else{
           Alpha = 2/(1+Length);
           Ema = Alpha * Close + (1-Alpha)*Ema[1];
           Eema = Alpha * Ema + (1-Alpha)*Eema[1];
           my_Dema = 2* Ema - Eema;
         }
         PlotNumeric("DEMA", my_DEMA, 0, Blue);
       End
     #+END_EXAMPLE
